<html>
<style>
	#inventorydiv{
		position: absolute;
		z-index: 9;
		background-color: #f1f1f1;
		text-align: center;
		width: 240;
		height: 155;
	}
	#inventorydivscroll{
		position: absolute;
		background-color: #f1f1f1;
		width: 240;
		height: 155;
		overflow-y: scroll;
	}
	#inventorydivheader{
		padding: 10px;
		cursor: move;
		z-index: 10;
		background-color: #000000;
		color: #fff;
		width: 205;
	}
	#inventoryitemname{
		position: absolute;
		text-align: centered;
		width: 225;
		height: 25;
		top: 200;
		overflow: auto;
	}
	#inventoryitemdesc{
		position: absolute;
		text-align: centered;
		width: 225;
		height: 25;
		top: 250;
	}
	#inventoryitemstats{
		position: absolute;
		text-align: centered;
		width: 225;
		height: 25;
		top: 225;
	}
	#shopdiv{
		position: absolute;
		z-index: 9;
		background-color: #f1f1f1;
		text-align: center;
		width: 225;
		height: 155;
		visibility: hidden;
		top: 100;
	}
	#shopdivheader{
		padding: 10px;
		cursor: move;
		z-index: 10;
		background-color: #000000;
		color: #fff;
		width: 190;
	}
	#shopdivscroll{
		position: absolute;
		background-color: #f1f1f1;
		width: 225;
		height: 155;
		overflow-y: scroll;
	}
</style>
<body>
<head>

<title>Cowboy Clicker</title>

<button id="PlayRamRanch" style="position: absolute; top: 0;">Play / Pause Ram Ranch</button>
<button id="EraseGame" style="position: absolute; top: 0; left: 155;">Erase Save (refresh page after)</button>
<label id="GameTitle" style="position: absolute; left: 10px; top: 15px; font-size: 40px; font-family: 'Comic Sans MS'; color: rgb(255,0,255)">Cowboy Clicker</label>
<label id="MoneyCounter" style="position: absolute; left: 10px; top: 75px;">Money: 0</label>
<button id="OpenShop" style="position: absolute; left: 10px; top: 75px">Open Shop</button>

<div id="inventorydiv">
	<div id="inventorydivheader">INVENTORY</div>
	<div id="inventorydivscroll"></div>
	<div id="inventoryitemname"></div>
	<div id="inventoryitemdesc"></div>
	<div id="inventoryitemstats"></div>
</div>

<div id="shopdiv">
	<div id="shopdivheader">SHOP</div>
	<div id="shopdivscroll">
		<button id="NewCowboy" style="position: absolute; left: 10px; top: 5px; width: 190; height: 30;">New Cowboy</button>
		<button id="BuyCowboyHat" style="position: absolute; left: 10px; top: 40px; width: 190; height: 30;">Buy Cowboy Hat: 100</button>
		<button id="BuyDiamondHat" style="position: absolute; left: 10px; top: 75px; width: 190; height: 30;">Buy Diamond Helmet: 500</button>
		<button id="BuyMexicoHat" style="position: absolute; left: 10px; top: 110px; width: 190; height: 30;">Buy Mexico Hat: 1000</button>
		<button id="BuyRamRanch" style="position: absolute; left: 10px; top: 145px; width: 190; height: 30;">Buy Ram Ranch: 5000</button>
	</div>
</div>


<script src="functions.js"></script>
<script src="hats.js"></script>
<script>

var Game = []
Game.Money = 0
Game.ShowMoney = 0
Game.MoneyPC = 1
Game.MoneyPS = 0
Game.CowboyAm = 0
Game.Cowboys = []
Game.Title = document.getElementById("GameTitle")
Game.MoneyCounter = document.getElementById("MoneyCounter")
Game.OpenShop = document.getElementById("OpenShop")
Game.NewCowboy = document.getElementById("NewCowboy")
Game.Inventory = []
Game.InventoryVisible = true
Game.InventoryMode = "none"
Game.InventoryFirst = true
Game.InventoryTarget = null

document.getElementById("inventorydiv").ctarget = null

Game.OpenShop.onclick = function(){
	if(Game.OpenShop.textContent=="Open Shop"){
		document.getElementById("shopdiv").style.visibility = "visible"
		Game.OpenShop.textContent = "Close Shop"
	}
	else{
		document.getElementById("shopdiv").style.visibility = "hidden"
		Game.OpenShop.textContent = "Open Shop"
	}
}

Game.NewCowboy.onclick = function(){
	if(Game.Money>=getPrice(500,Game.CowboyAm-1)){
		addMoney(getPrice(500,Game.CowboyAm-1)*-1)
		createCowboy()
	}
}

document.getElementById("BuyCowboyHat").onclick = function(){
	if(Game.Money>=100){
		addMoney(-100)
		addInventory(Hats.CowboyHat)
	}
	refreshInventoryGui()
}

document.getElementById("BuyDiamondHat").onclick = function(){
	if(Game.Money>=500){
		addMoney(-500)
		addInventory(Hats.DiamondHelmet)
	}
	refreshInventoryGui()
}

document.getElementById("BuyMexicoHat").onclick = function(){
	if(Game.Money>=1000){
		addMoney(-1000)
		addInventory(Hats.MexicoHat)
	}
	refreshInventoryGui()
}

document.getElementById("BuyRamRanch").onclick = function(){
	if(Game.Money>=5000){
		addMoney(-5000)
		addInventory(Hats.RamRanch)
	}
	refreshInventoryGui()
}

var rr = false
document.getElementById("PlayRamRanch").onclick = function(){if(rr==false){ramranch.play();rr=true;}else{ramranch.pause();rr=false;}}
document.getElementById("EraseGame").onclick = function(){eraseSave()}

document.getElementById("inventorydiv").style.left = document.body.clientWidth-parseInt(document.getElementById("inventorydiv").clientWidth)-10

function getPrice(base,am){
	return(Math.round(base*Math.pow(1.35,am)))
}

var titemimg = []
var titemvar = 0
function inventoryGUI(hide,title,mode,target){
	if(title!=null){document.getElementById("inventorydivheader").textContent=title}
	if(mode!=null){Game.InventoryMode=mode}
	if(target!=null){Game.InventoryTarget=target}
	if(hide==true){
		document.getElementById("inventorydiv").style.visibility = "hidden"
		InventoryVisible = false
		var imlength = clone(Object.keys(titemimg).length)
		for(invam=0;invam<imlength;invam++){
			inventorydivscroll.removeChild(document.getElementById(titemimg[titemvar].id))
			delete titemimg[titemvar]
			titemvar = titemvar +1
		}
	}
	else{
		document.getElementById("inventorydiv").style.visibility = "visible"
		InventoryVisible = true
		if(Game.InventoryFirst==true){
			Game.InventoryFirst = false
			document.getElementById("inventorydiv").style.left = document.body.clientWidth-parseInt(document.getElementById("inventorydiv").clientWidth)-10
		}
		var leftAm = 0
		for(i=0;i<inventoryLength();i++){
			var topAm = Math.floor(i/4)
			var itemImg = document.createElement("IMG")
			itemImg.src = Game.Inventory[i+1].Sprite
			itemImg.style.position = "absolute"
			itemImg.style.height = 50
			itemImg.style.width = 50
			itemImg.style.left = 5+(55*leftAm)
			itemImg.style.top = 5+(55*topAm)
			itemImg.num = i+1
			itemImg.id = "itemImg"+(i+1)
			leftAm = leftAm+1
			if(leftAm>=4){leftAm=0}
			itemImg.onclick = function(){
				useItem(Game.Inventory[this.num],target,title,mode)
				document.getElementById("inventoryitemname").textContent = ""
				document.getElementById("inventoryitemdesc").textContent = ""
				document.getElementById("inventoryitemstats").textContent = ""
			}
			itemImg.onmouseover = function(){
				document.getElementById("inventoryitemname").textContent = Game.Inventory[this.num].Name
				document.getElementById("inventoryitemdesc").textContent = Game.Inventory[this.num].Description
				document.getElementById("inventoryitemstats").textContent = "Click: " + Game.Inventory[this.num].Click + " | Per Second: " + Game.Inventory[this.num].PerSecond
			}
			itemImg.onmouseleave = function(){
				document.getElementById("inventoryitemname").textContent = ""
				document.getElementById("inventoryitemdesc").textContent = ""
				document.getElementById("inventoryitemstats").textContent = ""
			}
			titemimg.push(itemImg)
			document.getElementById("inventorydivscroll").appendChild(itemImg)
		}
	}
}
inventoryGUI(true)

function getInventoryItem(item){
	var getItem = null
	if(typeof item=="object"){
		getItem = item
	}
	else if(typeof item=="string"){
		for(num=0;num<Object.keys(Game.Inventory).length;num++){
			if(Game.Inventory[num]!=null&&Game.Inventory[num].Name==item){
				getItem = Game.Inventory[num]
				break
			}
		}
	}
	else if(typeof item=="number"&&target.Inventory[item-1]!=null){getItem = Game.Inventory[item-1]}
	else{
		return("tf are you doing lol")
	}
	if(getItem!=null){
		return(getItem)
	}
}

function addInventory(item){
  Game.Inventory[Object.keys(Game.Inventory).length+1] = clone(item)
}

function refreshInventory(){
	if(inventoryLength()>0){
		for(x=1;x<Object.keys(Game.Inventory).length+1;x++){
			if(Game.Inventory[x]==null&&Game.Inventory[x+1]!=null){
				Game.Inventory[x] = clone(Game.Inventory[x+1])
				Game.Inventory[x+1] = null
				x = 1
			}
			else if(Game.Inventory[x+1]==null&&Game.Inventory[1]==null){
				Game.Inventory[1] = clone(Game.Inventory[2])
				Game.Inventory[2] = null
				x = 1
			}
			if(Game.Inventory[x]!=null){Game.Inventory[x].num = x}
		}
	}
}

function updateText(){
	Game.MoneyCounter.textContent = "Cowboy Points: " + Math.round(Game.ShowMoney)
	Game.OpenShop.style.left = 15+parseInt(Game.MoneyCounter.clientWidth)
	//console.log(showmoneyloopgoing)
	for(i=1;i<Object.keys(Game.Cowboys).length+1;i++){
		var current = Game.Cowboys["Cowboy"+i]
		current.CowboyLabel.textContent = "Cowboy "+i
		current.CowboyHatEquip.textContent = "Hat"
		current.CowboyHatEquip.style.left = 130+parseInt(current.CowboyLabel.clientWidth)
		current.CowboyHatDeequip.style.left = 135+parseInt(current.CowboyLabel.clientWidth)+parseInt(current.CowboyHatEquip.clientWidth)
		if(current.Equipped!=null){
			current.CowboyHatDeequip.style.visibility = "visible"
			current.CowboyHatDeequip.textContent = "-"
			current.HatClick = current.Equipped.Click
			current.HatPerSecond = current.Equipped.PerSecond
			current.CowboyHat.src = current.Equipped.Sprite
			current.CowboyHat.style.visibility = "visible"
		}
		else{
			current.CowboyHatDeequip.style.visibility = "hidden"
			current.CowboyHatDeequip.textContent = "wat"
			current.HatClick = 0
			current.HatPerSecond = 0
			current.CowboyHat.style.visibility = "hidden"
		}
		current.CowboyStats.textContent = "Click: " + current.PerClick
		current.UpgradeCowboyClick.textContent = "Upgrade (" + getPrice(current.PerClickBase,current.PerClick-1) + ")"
		current.UpgradeCowboyClick.style.left = 130+parseInt(current.CowboyStats.clientWidth)
		current.CowboyPSStats.textContent = "Per Second: " +current.PerSecond
		current.UpgradeCowboyPS.textContent = "Upgrade (" + getPrice(current.PerSecondBase,current.PerSecond) + ")"
		current.UpgradeCowboyPS.style.left = 130+parseInt(current.CowboyPSStats.clientWidth)
	}
	Game.NewCowboy.textContent = "New Cowboy: "+getPrice(500,Game.CowboyAm-1)
}

var showmoneyloopgoing = 0
function addMoney(am,speed){
	Game.Money = Game.Money+am
	Game.ShowMoney = Game.Money
	// var speedam
	// if(am>0){speedam=am}else if(am<0){speedam=am*-1}
	// if(speed==null){if(speedam<10){speed=speedam}else{speed=10}}
	// var x = 0
	// var loop = setInterval(function(){
	// 	if(am>0&&am<1){
	// 		Game.ShowMoney=Game.ShowMoney+am
	// 		clearInterval(loop)
	// 	}
	// 	else if(am>0){
	// 		Game.ShowMoney=Game.ShowMoney+am/speed
	// 		x = x+1
	// 		if(x>=speed){
	// 			clearInterval(loop)
	// 		}
	// 	}
	// 	else if(am<0){
	// 		Game.ShowMoney=Game.ShowMoney+am/speed
	// 		x = x+1
	// 		if(x>=speed){
	// 			clearInterval(loop)
	// 		}
	// 	}
	// 	updateText()
	// },1)
}

var cowboySetTop = 100
var cowboySetLeft = 0
var ccba = 0
function createCowboy(){
	if(ccba==10){
		cowboySetTop = cowboySetTop+200
		cowboySetLeft = 0
		ccba = 0
	}
	Game.Cowboys["Cowboy"+(Game.CowboyAm+1)] = []
	var CowboySprite = document.createElement("IMG")
	CowboySprite.src = "textures/cowboy.png"
	CowboySprite.style.position = "absolute"
	CowboySprite.style.height = 100
	CowboySprite.style.width = 100
	CowboySprite.style.top = (Game.CowboyAm+1)*125
	CowboySprite.style.left = 10
	CowboySprite.num = Game.CowboyAm+1
	CowboySprite.cb = Game.Cowboys["Cowboy"+(Game.CowboyAm+1)]
	var CowboyLabel = document.createElement("LABEL")
	CowboyLabel.style.position = "absolute"
	CowboyLabel.style.height = 18
	CowboyLabel.style.top = (Game.CowboyAm+1)*125+10
	CowboyLabel.style.left = 125
	var CowboyHatEquip = document.createElement("BUTTON")
	CowboyHatEquip.style.position = "absolute"
	CowboyHatEquip.style.height = 18
	CowboyHatEquip.style.top = (Game.CowboyAm+1)*125+10
	CowboyHatEquip.style.left = 125+parseInt(CowboyLabel.clientWidth)
	CowboyHatEquip.cb = Game.Cowboys["Cowboy"+(Game.CowboyAm+1)]
	CowboyHatEquip.triggered = false
	var CowboyHatDeequip = document.createElement("BUTTON")
	CowboyHatDeequip.style.position = "absolute"
	CowboyHatDeequip.style.height = 18
	CowboyHatDeequip.style.top = (Game.CowboyAm+1)*125+10
	CowboyHatDeequip.style.left = 125+parseInt(CowboyLabel.clientWidth)+parseInt(CowboyHatEquip.clientWidth)
	CowboyHatDeequip.cb = Game.Cowboys["Cowboy"+(Game.CowboyAm+1)]
	CowboyHatDeequip.triggered = false
	var CowboyStats = document.createElement("LABEL")
	CowboyStats.style.position = "absolute"
	CowboyStats.style.height = 18
	CowboyStats.style.top = (Game.CowboyAm+1)*125+35
	CowboyStats.style.left = 125
	var UpgradeCowboyClick = document.createElement("BUTTON")
	UpgradeCowboyClick.style.position = "absolute"
	UpgradeCowboyClick.style.height = 18
	UpgradeCowboyClick.style.top = (Game.CowboyAm+1)*125+35
	UpgradeCowboyClick.style.left = 125+parseInt(CowboyStats.clientWidth)
	UpgradeCowboyClick.cb = Game.Cowboys["Cowboy"+(Game.CowboyAm+1)]
	var CowboyPSStats = document.createElement("LABEL")
	CowboyPSStats.style.position = "absolute"
	CowboyPSStats.style.height = 18
	CowboyPSStats.style.top = (Game.CowboyAm+1)*125+60
	CowboyPSStats.style.left = 125
	var UpgradeCowboyPS = document.createElement("BUTTON")
	UpgradeCowboyPS.style.position = "absolute"
	UpgradeCowboyPS.style.height = 18
	UpgradeCowboyPS.style.top = (Game.CowboyAm+1)*125+60
	UpgradeCowboyPS.style.left = 125+parseInt(CowboyStats.clientWidth)
	UpgradeCowboyPS.cb = Game.Cowboys["Cowboy"+(Game.CowboyAm+1)]
	Game.CowboyAm = Game.CowboyAm+1
	cowboySetLeft = cowboySetLeft+1
	var CowboyHat = document.createElement("IMG")
	CowboyHat.style.position = "absolute"
	CowboyHat.style.height = 25
	CowboyHat.style.width = 50
	CowboyHat.style.top = (Game.CowboyAm+1)*125-145
	CowboyHat.style.left = 35
	CowboyHat.style.visibility = "hidden"
	ccba = ccba+1
	Game.Cowboys["Cowboy"+(Game.CowboyAm)].CowboySprite = CowboySprite
	Game.Cowboys["Cowboy"+(Game.CowboyAm)].CowboyLabel = CowboyLabel
	Game.Cowboys["Cowboy"+(Game.CowboyAm)].CowboyHatEquip = CowboyHatEquip
	Game.Cowboys["Cowboy"+(Game.CowboyAm)].CowboyHatDeequip = CowboyHatDeequip
	Game.Cowboys["Cowboy"+(Game.CowboyAm)].CowboyStats = CowboyStats
	Game.Cowboys["Cowboy"+(Game.CowboyAm)].UpgradeCowboyClick = UpgradeCowboyClick
	Game.Cowboys["Cowboy"+(Game.CowboyAm)].CowboyPSStats = CowboyPSStats
	Game.Cowboys["Cowboy"+(Game.CowboyAm)].UpgradeCowboyPS = UpgradeCowboyPS
	Game.Cowboys["Cowboy"+(Game.CowboyAm)].PerClick = 1
	Game.Cowboys["Cowboy"+(Game.CowboyAm)].PerClickBase = 15
	Game.Cowboys["Cowboy"+(Game.CowboyAm)].PerSecond = 0
	Game.Cowboys["Cowboy"+(Game.CowboyAm)].PerSecondBase = 50
	Game.Cowboys["Cowboy"+(Game.CowboyAm)].CowboyNum = clone(Game.CowboyAm)
	Game.Cowboys["Cowboy"+(Game.CowboyAm)].Equipped = null
	Game.Cowboys["Cowboy"+(Game.CowboyAm)].HatClick = 0
	Game.Cowboys["Cowboy"+(Game.CowboyAm)].HatPerSecond = 0
	Game.Cowboys["Cowboy"+(Game.CowboyAm)].CowboyHat = CowboyHat
	document.body.appendChild(Game.Cowboys["Cowboy"+Game.CowboyAm].CowboySprite)
	document.body.appendChild(Game.Cowboys["Cowboy"+Game.CowboyAm].CowboyLabel)
	document.body.appendChild(Game.Cowboys["Cowboy"+Game.CowboyAm].CowboyHatEquip)
	document.body.appendChild(Game.Cowboys["Cowboy"+Game.CowboyAm].CowboyHatDeequip)
	document.body.appendChild(Game.Cowboys["Cowboy"+Game.CowboyAm].CowboyStats)
	document.body.appendChild(Game.Cowboys["Cowboy"+Game.CowboyAm].UpgradeCowboyClick)
	document.body.appendChild(Game.Cowboys["Cowboy"+Game.CowboyAm].CowboyPSStats)
	document.body.appendChild(Game.Cowboys["Cowboy"+Game.CowboyAm].UpgradeCowboyPS)
	document.body.appendChild(Game.Cowboys["Cowboy"+Game.CowboyAm].CowboyHat)
	CowboyHatEquip.onclick = function(){
		if(InventoryVisible==false&&CowboyHatEquip.triggered==false||InventoryVisible==true&&Game.InventoryMode=="equip"&&CowboyHatEquip.triggered==false){
			CowboyHatEquip.triggered = true
			inventoryGUI(true)
			inventoryGUI(false,"EQUIP COWBOY "+CowboyHatEquip.cb.CowboyNum,"equip",CowboyHatEquip.cb)
			if(document.getElementById("inventorydiv").ctarget!=null){
				document.getElementById("inventorydiv").ctarget.CowboyHatEquip.triggered = false
			}
			document.getElementById("inventorydiv").ctarget = CowboyHatEquip.cb
		}
		else{
			CowboyHatEquip.triggered = false
			inventoryGUI(true)
		}
	}
	CowboySprite.onclick = function(){
		addMoney(CowboySprite.cb.PerClick)
		addMoney(CowboySprite.cb.HatClick)
		updateText()
	}
	UpgradeCowboyClick.onclick = function(){
		var PerClick = UpgradeCowboyClick.cb.PerClick
		if(Game.Money>=getPrice(UpgradeCowboyClick.cb.PerClickBase,PerClick-1)){
			addMoney(getPrice(UpgradeCowboyClick.cb.PerClickBase,PerClick-1)*-1)
			UpgradeCowboyClick.cb.PerClick = UpgradeCowboyClick.cb.PerClick+1
		}
		updateText()
	}
	UpgradeCowboyPS.onclick = function(){
		var PerSecond = UpgradeCowboyClick.cb.PerSecond
		if(Game.Money>=getPrice(UpgradeCowboyClick.cb.PerSecondBase,PerSecond-1)){
			addMoney(getPrice(UpgradeCowboyClick.cb.PerSecondBase,PerSecond-1)*-1)
			UpgradeCowboyClick.cb.PerSecond = UpgradeCowboyClick.cb.PerSecond+1
		}
		updateText()
	}
	CowboyHatDeequip.onclick = function(){
		if(CowboyHatDeequip.cb.Equipped!=null){
			addInventory(clone(CowboyHatDeequip.cb.Equipped))
			CowboyHatDeequip.cb.Equipped = null
		}
		refreshInventoryGui()
	}
}
createCowboy()
updateText()

dragElement(document.getElementById(("inventorydiv")))
dragElement(document.getElementById(("shopdiv")))
function dragElement(elmnt) {
  var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
  if (document.getElementById(elmnt.id + "header")) {
    /* if present, the header is where you move the DIV from:*/
    document.getElementById(elmnt.id + "header").onmousedown = dragMouseDown;
  } else {
    /* otherwise, move the DIV from anywhere inside the DIV:*/
    elmnt.onmousedown = dragMouseDown;
  }

  function dragMouseDown(e) {
    e = e || window.event;
    // get the mouse cursor position at startup:
    pos3 = e.clientX;
    pos4 = e.clientY;
    document.onmouseup = closeDragElement;
    // call a function whenever the cursor moves:
    document.onmousemove = elementDrag;
  }

  function elementDrag(e) {
    e = e || window.event;
    // calculate the new cursor position:
    pos1 = pos3 - e.clientX;
    pos2 = pos4 - e.clientY;
    pos3 = e.clientX;
    pos4 = e.clientY;
    // set the element's new position:
    elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
    elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";
  }

  function closeDragElement() {
    /* stop moving when mouse button is released:*/
    document.onmouseup = null;
    document.onmousemove = null;
  }
}

var perSecondAddTotal = 0
var saveTimer = 0
setInterval(function(){
	refreshInventory()
	updateText()
	perSecondAddTotal = 0
	for(i=1;i<Object.keys(Game.Cowboys).length+1;i++){
		var current = Game.Cowboys["Cowboy"+i]
		perSecondAddTotal = perSecondAddTotal+current.PerSecond+current.HatPerSecond
	}
	if(Game.CowboyAm>=18){
		Game.Title.textContent = "18 naked cowboys in the showers at ram ranch"
	}
	addMoney(perSecondAddTotal/100)
	saveTimer = saveTimer+1
	if(saveTimer>=5000){
		save()
		var textBackup = clone(Game.Title.textContent)
		Game.Title.textContent = Game.Title.textContent+" (game saved)"
		setTimeout(function(){Game.Title.textContent=textBackup},1000)
		saveTimer = 0
	}
},1)

var ramranch = new Audio("sounds/ramranch.mp3")
ramranch.loop = true
// ramranch.play()

var oldSM = 0
setInterval(function(){
	if(Game.ShowMoney==oldSM){
		if(Game.ShowMoney!=Game.Money){Game.ShowMoney=Game.Money}
	}
	else{oldSM = Game.ShowMoney}
},1000)

if(Object.keys(localStorage).length>0){load()}

</script>

</head>
</body>
</html>